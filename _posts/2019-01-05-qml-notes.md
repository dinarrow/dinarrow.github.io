---
theme: jekyll-theme-hacker
layout: default
title: QML Notes
date: 2019-01-05  00:00:00
---

# QML Notes

Resently update Qt to version 5.12.

While review code I started getting QML Warnings about using Anchors inside Layouts.

```
Detected anchors on an item that is managed by a layout. This is undefined behavior; use Layout.alignment instead.
```

After some investigation it became clear that issues exist with mixing the three possible methods of component positioning (Manual, Anchors and Layouts) and this can result in complex code and unexpected behaviour.

I found that, in particular, that Layouts and Anchors can be mixed but only if some none obvious rules are followed. Hence these notes.

# 1. Anchors inside Layout Components

To use Anchors inside a Layout Component the anchored components must be wrapped inside a non-layout component ( i.e. Rectange or Item ). The wrapping component then needs to be positioned ( normally to the dimensions of the outer Layout component with Layout.fillHeight, Layout.fillWidth)
with Layout Properties.


# 2. Layout Component inside Anchor Components

To use a Layout component inside an Anchor component there is a bit more flexability. Anchors can be used or Layout properties like Layout.fillWidth. In general though Layout properties should be favoured for simple positioning. Anchors however may give some finer control due to the wider range of options.


# 3. Simplicity is better than Fine Detail

While it is possible to do some very fine detail positioning it is differcult to control particularly when switching from portrait to landscape or changing aspect ratios. Layouts are generally simpler than Anchors but simplifying the overall positioning can also be a benefical approach.

# 4. Non-visible Component do not impact on positioning

At least in the case Layout components, when they are not visible they have no effect on positioning. This means that when different positioning is required for different statuses ( Portrait/Landscape) it is better to duplicate components in separate simplified layouts and hide the inactive layouts.

# 5. Avoid fixed Heights and Widths

It is better to let the positioning algorithm sort out heights and widths than fixing them even if with calculation. The need to use fixed values is a smell and alternatives should be prefered. Margins are less smelly but large values may cause positioning conflicts and should be used with caution.

# 6. Layout.alignment effects the contents of the Layout component

The documentation is unclear.
```
This property allows you to specify the alignment of an item within the cell(s) it occupies.
```

Test indicate however that Layout.alignment is set for the outer Layout component and applies to all of the contained/child components. This can be seen as logical in that alignment properties only make sense in Row or Column Layouts where all child components should have the same alignment.

# 7. All other Layout Properties apply to the component itself

All Layout properties other than alignment apply to the individual component, either Layout or Anchor. So for example to make all components in and outer layout fill the width Layout.fillWidths required in each component.

# 8. Margins are outside the component

Setting a Layout margin has effect outside the component. So a margin position the individual component rather than the position of any contained component. Setting a margin on an outer component ( i.e ColumnLayout) may appear to offset the contained components but in fact offsets the outer component itself.
  
